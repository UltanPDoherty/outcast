ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
nrow(x)
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
nrow(z)
ombc2_s1n_123m500$rem_dens[501]
load_all()
ombc2_s1n_123m500_time <- system.time({
ombc2_s1n_123m500 <- ombc2_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
})
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
colSums(z)
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
colSums(z)
colSums(ombc2_s1n_123m500$z)
sum(z)
nrow(x0)
nrow(x)
sum(outlier_rank == 0)
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
nrow(x)
nrow(z)
mix$best_model$model_objs[[1]]$mu[[k]]
mix$best_model$model_objs[[1]]$mu[[1]]
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
dim(dens_mat)
load_all()
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
plot(ombc2_s1n_123m500_rev$rem_dens)
plot(500:1, ombc2_s1n_123m500_rev$rem_dens, type = "l")
plot(500:0, ombc2_s1n_123m500_rev$rem_dens, type = "l")
ombc2_s1n_123m500_rev$rem_dens[501]
ombc2_s1n_123m500_rev$rem_dens[1]
ombc2_s1n_123m500_rev$rem_dens[50]
ombc2_s1n_123m500_rev$rem_dens[500]
plot(0:500, ombc2_s1n_123m500$rem_dens, type = "l")
plot(1:500, ombc2_s1n_123m500$rem_dens, type = "l")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/ombc2_s1n_123m500.R")
load_all()
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/ombc2_s1n_123m500.R")
library(devtools)
load_all()
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos"
)
s2n <- read.table(paste0(folder, "/uef_sipu_data/outlier_datasets/s2n.txt"))
ombc2_s2n_123m500_time <- system.time({
ombc2_s2n_123m500 <- ombc2_gmm(
x = s2n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
ombc2_s2n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s2n_123m500,
x = s2n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
})
saveRDS(
ombc2_s2n_123m500,
paste0(folder, "/Removal_Density/ombc2_s2n_123m500.rds")
)
write.table(
ombc2_s2n_123m500_time,
paste0(folder, "/Removal_Density/ombc2_s2n_123m500_time.txt")
)
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/ombc2_s3n_123m500.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/ombc2_s4n_123m500.R")
plot(500:0, ombc2_s3n_123m500_rev, type = "l")
plot(500:1, ombc2_s3n_123m500_rev, type = "l")
plot(500:1, ombc2_s3n_123m500_rev$rem_dens, type = "l")
plot(1:500, ombc2_s3n_123m500$rem_dens, type = "l")
plot(s4n, col = 1 + s4n_label)
s4n_label <- read.table(
paste0(folder, "/uef_sipu_data/outlier_datasets/s4n_label.txt")
) |> dplyr::pull()
plot(s4n, col = 1 + s4n_label)
palette(paletteer::paletteer_d("colorBlindness::paletteMartin"))
plot(s4n, col = 1 + s4n_label)
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos"
)
s4n <- read.table(paste0(folder, "/uef_sipu_data/outlier_datasets/s4n.txt"))
s4n_label <- read.table(
paste0(folder, "/uef_sipu_data/outlier_datasets/s4n_label.txt")
) |> dplyr::pull()
ombc_s4n_123m500 <- readRDS(
paste0(folder, "/Removal_Density/ombc_s4n_123m500.rds")
)
s4n_ombc_rank <- ombc_s4n_123m500$outlier_rank
s4n_ombc_mindens <- ombc_s4n_123m500$min_dens
plot(
0:500, ombc_s4n_123m500$min_dens, type = "l",
main = paste0("s4n Removal Density")
)
abline(v = c(200, 240))
s4n_cpop <- cpop::cpop(s4n_ombc_mindens, 0:500, grid = 200:240, minseglen = 41)
s4n_cpop
s4n_choice <- s4n_cpop@changepoints[2]
?mvtnorm::dmvnorm
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos"
)
s4n <- read.table(paste0(folder, "/uef_sipu_data/outlier_datasets/s4n.txt"))
s4n_label <- read.table(
paste0(folder, "/uef_sipu_data/outlier_datasets/s4n_label.txt")
) |> dplyr::pull()
ombc_s4n_123m500 <- readRDS(
paste0(folder, "/Removal_Density/ombc_s4n_123m500.rds")
)
s4n_ombc_rank <- ombc_s4n_123m500$outlier_rank
s4n_ombc_mindens <- ombc_s4n_123m500$min_dens
ombc_s4n_123m500$outlier_bool
s4n_bool
s4n_ombc_rank <- ombc_s4n_123m500$outlier_rank
s4n_ombc_mindens <- ombc_s4n_123m500$min_dens
plot(
0:500, ombc_s4n_123m500$min_dens, type = "l",
main = paste0("s4n Removal Density")
)
abline(v = c(200, 240))
s4n_cpop <- cpop::cpop(s4n_ombc_mindens, 0:500, grid = 200:240, minseglen = 41)
s4n_cpop
s4n_choice <- s4n_cpop@changepoints[2]
s4n_choice
s4n_bool <- !(s4n_ombc_rank == 0 | s4n_ombc_rank > s4n_choice)
s4n_tp <- sum((s4n_label == 0) & s4n_bool)
s4n_fp <- sum((s4n_label != 0) & s4n_bool)
s4n[s4n_bool, ]
s4n_dist <- s4n[s4n_bool, ]
s4n_dist <- dist(s4n[s4n_bool, ])
s4n_hclust <- hclust(s4n_dist)
plot(s4n_hclust)
s4n_cutree <- cutree(s4n_hclust, k = 15)
str(s4n_cutree)
abline(s4n_cutree)
abline(h = s4n_cutree)
abline(h = s4n_hclust$height[15])
abline(h = s4n_hclust$height[sum(s4n_bool) - 15])
abline(h = (s4n_hclust$height[sum(s4n_bool) - 15] + s4n_hclust$height[sum(s4n_bool) - 16]) / 2)
plot(s4n_hclust)
abline(h = (s4n_hclust$height[sum(s4n_bool) - 15] + s4n_hclust$height[sum(s4n_bool) - 16]) / 2)
plot(s4n_hclust)
abline(h = (s4n_hclust$height[sum(s4n_bool) - 15] + s4n_hclust$height[sum(s4n_bool) - 14]) / 2)
s4n_obsnum <- sum(s4n_bool)
plot(s4n_hclust)
abline(h = (s4n_hclust$height[s4n_obsnum - 15] + s4n_hclust$height[s4n_obsnum - 14]) / 2)
s4n_hlust_z <- matrix(0, nrow = s4n_obsnum, ncol = 15)
for (i in seq_len(s4n_obsnum)) {
s4n_hlust_z[i, s4n_cutree[i]] <- 1
}
s4n_dist <- dist(s4n[!s4n_bool, ])
s4n_hclust <- hclust(s4n_dist)
s4n_cutree <- cutree(s4n_hclust, k = 15)
s4n_obsnum <- sum(!s4n_bool)
plot(s4n_hclust)
abline(h = (s4n_hclust$height[s4n_obsnum - 15] + s4n_hclust$height[s4n_obsnum - 14]) / 2)
s4n_hlust_z <- matrix(0, nrow = s4n_obsnum, ncol = 15)
for (i in seq_len(s4n_obsnum)) {
s4n_hlust_z[i, s4n_cutree[i]] <- 1
}
s4n_hc_labels <- rep(0, 5350)
s4n_hc_labels[!s4n_bool] <- s4n_cutree
mixture::ARI(s4n_label, s4n_hc_labels)
plot(s4n, col = s4n_hc_labels)
plot(s4n, col = 1 + s4n_hc_labels)
palette(paletteer::paletteer_d("colorBlindness::paletteMartin"))
plot(s4n, col = 1 + s4n_hc_labels)
>hclust
?hclust
s4n_hclust <- hclust(s4n_dist, method = "ward.D2")
s4n_cutree <- cutree(s4n_hclust, k = 15)
s4n_obsnum <- sum(!s4n_bool)
plot(s4n_hclust)
abline(h = (s4n_hclust$height[s4n_obsnum - 15] + s4n_hclust$height[s4n_obsnum - 14]) / 2)
s4n_hlust_z <- matrix(0, nrow = s4n_obsnum, ncol = 15)
for (i in seq_len(s4n_obsnum)) {
s4n_hlust_z[i, s4n_cutree[i]] <- 1
}
s4n_hc_labels <- rep(0, 5350)
s4n_hc_labels[!s4n_bool] <- s4n_cutree
plot(s4n, col = 1 + s4n_hc_labels)
mixture::ARI(s4n_label, s4n_hc_labels)
library(devtools)
load_all()
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos"
)
s1n <- read.table(paste0(folder, "/uef_sipu_data/outlier_datasets/s1n.txt"))
ombc2_s1n_123m500_time <- system.time({
ombc2_s1n_123m500 <- ombc2_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
ombc2_s1n_123m500_rev <- ombc2_gmm_reverse(
ombc2_s1n_123m500,
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
print_interval = 10
)
})
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/ombc2_123m500.R")
ombc2_123m500("s1n")
library(devtools)
load_all()
ombc2_123m500("s1n")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/ombc2_123m500_twoway.R")
ombc2_123m500_twoway("s1n")
library(devtools)
load_all()
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/ombc2_twoway/run_ombc2_twoway.R")
run_ombc2_twoway("s2n", 123, 500)
?break
?rev
4281 / 3600
(4281 - 3600) / 3600
(4281 - 3600) / 60
?gpcm::mixture
?mixture::gpcm
?stop
2.8 * 100
/ 60
2.8 * 100 / 60
hms(1900)
lubridate::hms(1900)
lubridate::seconds_to_period(1900)
lubridate::seconds_to_period(11466)
lubridate::seconds_to_period(6942)
lubridate::seconds_to_period(5842)
lubridate::seconds_to_period(4806)
lubridate::seconds_to_period(2555)
lubridate::seconds_to_period(3082)
lubridate::seconds_to_period(1882)
lubridate::seconds_to_period(1882)
lubridate::seconds_to_period(994)
1975 / 60
930 / 60
library(devtools)
load_all()
load_all()
forward <- summit_gmm_forward(gmm[, -3], 3, 80)
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
forward <- summit_gmm_forward(gmm[, -3], 3, 80)
backward <- summit_gmm_backward(forward)
return_bool <- (outlier_rank == (max_out - i + 1))
which(return_bool)
length(dens_vec)
max_out - i + 1
outlier_rank[3520]
load_all()
forward <- summit_gmm_forward(gmm[, -3], 3, 80)
max(dens_vec - dens_vec2)
median(dens_vec)
median(dens_vec2)
min(dens_vec2)
min(dens_vec)
sum(dens_vec != dens_vec2)
min(dens_vec - dens_vec2)
max(abs(dens_vec - dens_vec2))
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
min(dens_vec) - min(dens_vec2)
forward <- summit_gmm_forward(gmm[, -3], 3, 80)
load_all()
forward <- summit_gmm_forward(gmm[, -3], 3, 80)
backward <- summit_gmm_backward(forward)
plot(forward$rem_dens, type = "l")
lines(backward$rem_dens)
plot(forward$rem_dens, type = "l")
lines(backward$rem_dens, col = "red")
summit_s1n_seed123m500 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/Removal_Density/summit_s1n_seed123m500.rds")
plot(summit_s1n_seed123m500$forward$rem_dens)
plot(summit_s1n_seed123m500$forward$rem_dens, type = "l")
lines(summit_s1n_seed123m500$backward$rem_dens, type = "l")
abline(v = c(280))
abline(v = c(260))
abline(v = c(270))
abline(v = c(250))
load_all()
summit_gmm_backward(summit_s1n_seed123m500, 10)
summit_gmm_backward(summit_s1n_seed123m500$forward, 10)
plot(s1n, col = 1 + return_bool)
plot(x0, col = 1 + return_bool)
plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
rem_dens[i]
plot(rem_dens)
plot(rem_dens, type = "l")
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
par(mfrow = c(1, 2)); plot(rem_dens, type = "l"); plot(x0, col = 1 + return_bool, pch = 1 + return_bool)
load_all()
forward_gmm <- summit_gmm_forward(gmm[, -3], 3, 80)
return_gmm <- summit_gmm_return(forward_gmm)
load_all()
return_gmm <- summit_gmm_return(forward_gmm)
dim(z)
sum(subset_bool)
load_all()
return_gmm <- summit_gmm_return(forward_gmm)
load_all()
return_gmm <- summit_gmm_return(forward_gmm)
backward <- summit_gmm_backward(forward)
backward_gmm <- summit_gmm_backward(forward_gmm)
plot(forward_gmm$rem_dens, type = "l")
par(mfrow = c(1, 1))
lines(backward_gmm$rem_dens)
plot(forward_gmm$rem_dens, type = "l")
lines(backward_gmm$rem_dens)
lines(return_gmm$rem_dens)
load_all()
return_gmm <- summit_gmm_return(forward_gmm)
plot(forward_gmm$rem_dens, type = "l")
lines(backward_gmm$rem_dens)
lines(return_gmm$rem_dens)
lines(backward_gmm$rem_dens, col = "red")
lines(return_gmm$rem_dens, col = "blue")
backward_gmm$rem_dens - return_gmm$rem_dens
length(return_gmm$loglike)
length(return_gmm$rem_dens)
load_all()
return_gmm <- summit_gmm_return(forward_gmm)
length(return_gmm$loglike)
document()
document()
document()
document()
document()
load_all()
return_gmm <- summit_gmm_return(forward_gmm)
forward_gmm <- summit_gmm_forward(gmm[, -3], 3, 80)
backward_gmm <- summit_gmm_backward(forward_gmm)
plot(forward_gmm$rem_dens, type = "l")
lines(backward_gmm$rem_dens, col = "red")
load_all()
backward_gmm <- summit_gmm_backward(forward_gmm)
plot(forward_gmm$rem_dens, type = "l")
lines(backward_gmm$rem_dens, col = "red")
backward_gmm$outlier_rank
table(backward_gmm$outlier_rank)
load_all()
backward_gmm <- summit_gmm_backward(forward_gmm)
table(backward_gmm$outlier_rank)
sum(forward_gmm$outlier_rank == backward_gmm$outlier_rank)
max(forward_gmm$outlier_rank - backward_gmm$outlier_rank)
plot(forward_gmm$outlier_rank, backward_gmm$outlier_rank)
cbind(forward_gmm$outlier_rank[forward_gmm$outlier_rank != 0], backward_gmm$outlier_rank[forward_gmm$outlier_rank != 0])
document()
