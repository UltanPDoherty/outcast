seed = 123,
print_interval = 1,
alpha = 0
)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 1,
alpha = 0
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 1,
alpha = 0
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 1,
alpha = 0
)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 1,
alpha = 0
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
cwm()
cwm
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 1,
alpha = 1
)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 1,
alpha = 1
)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 1
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
ombc_p1_gmm <- ombc_gmm(
x = ombc_p1$X1,
comp_num = 2,
max_out = 1000,
mnames = "VVV",
seed = 123,
print_interval = 100
)
ombc_p1_gmm <- ombc_gmm(
x = ombc_p1$X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100
)
mixture::gpcm(ombc_p1$X1, G = 2, mnames = "V", start = 2)
mixture::gpcm(as.matrix(ombc_p1$X1), G = 2, mnames = "V", start = 2)
cwm2
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
?rstandard
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0
)
hat(mod_g)
hatvalues(mod_g)
class(hatvalues(mod_g))
diag(class(hatvalues(mod_g)))
as.matrix(class(hatvalues(mod_g)))
as.matrix(hatvalues(mod_g))
as.matrix(hatvalues(mod_g), nrow = 2050, ncol = 2050)
dim(as.matrix(hatvalues(mod_g)))
dim(diag(hatvalues(mod_g)))
diag(diag(hatvalues(mod_g)))
str(mod_g)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0
)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0
)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 1000,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
ombc_p1_gmm <- ombc_gmm(
x = ombc_p1$X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100
)
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
ombc_p1_lcwm$outlier_rank
ombc_p1_lcwm$outlier_rank[1001:1050]
ombc_p1_lcwm$outlier_rank[2001:2050]
setdiff(ombc_p1_lcwm$outlier_rank[2001:2050], 1:50)
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 1
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 1
)
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
mod_g$weights
plot(mod_g$weights)
sum(mod_g$weights * mod_g$residuals^2)
sum(mod_g$weights * mod_g$residuals^2) / sum(mod_g$weights)
sum(mod_g$weights)
n_g
y_sigma_g
stats::sigma(mod_g)
sqrt(sum(mod_g$weights * mod_g$residuals^2) / sum(mod_g$weights))
par(mfrow = c(1, 2))
plot(0:40, ombc_mlr_p1$distrib_diffs, type = "l")
n <- 1000
mu <- c(+1)
sigma <- as.matrix(0.1)
beta <- c(1, 1)
error_sd <- 0.5
noisy_mlr_p1 <- simulate_noisy_mlr(
n, mu, sigma, beta,
error_sd,
outlier_num = 20, seed = 123,
crit_val = 0.9999
)
ombc_mlr_p1 <- ombc_mlr(
noisy_mlr_p1$covariates,
noisy_mlr_p1$responses,
max_out = 40
)
par(mfrow = c(1, 2))
plot(0:40, ombc_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_mlr_p1$outlier_bool
)
par(mfrow = c(1, 1))
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_mlr_p1$outlier_bool
)
lcwm_p1$models[[1]]$cluster == 1
ombc_mlr(
ombc_p1$X1[lcwm_p1$models[[1]]$cluster == 1],
ombc_p1$Y[lcwm_p1$models[[1]]$cluster == 1],
max_out = 100
)
ultan <- ombc_mlr(
ombc_p1$X1[lcwm_p1$models[[1]]$cluster == 1],
ombc_p1$Y[lcwm_p1$models[[1]]$cluster == 1],
max_out = 100
)
ultan$outlier_num
ultan1 <- ombc_mlr(
ombc_p1$X1[lcwm_p1$models[[1]]$cluster == 1],
ombc_p1$Y[lcwm_p1$models[[1]]$cluster == 1],
max_out = 100
)
ultan2 <- ombc_mlr(
ombc_p1$X1[lcwm_p1$models[[1]]$cluster == 2],
ombc_p1$Y[lcwm_p1$models[[1]]$cluster == 2],
max_out = 100
)
ultan1$outlier_num
ultan2$outlier_num
plot(
ombc_p1$X1[lcwm_p1$models[[1]]$cluster == 2],
ombc_p1$Y[lcwm_p1$models[[1]]$cluster == 2],
col = ultan2$outlier_bool
)
plot(
ombc_p1$X1[lcwm_p1$models[[1]]$cluster == 2],
ombc_p1$Y[lcwm_p1$models[[1]]$cluster == 2],
col = ultan2$outlier_bool + 1
)
plot(
ombc_p1$X1[lcwm_p1$models[[1]]$cluster == 1],
ombc_p1$Y[lcwm_p1$models[[1]]$cluster == 1],
col = ultan1$outlier_bool + 1
)
?hat
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
plot(student_resids_g, student_resids_g2)
length(student_resids_g)
dim(student_resids_g)
hat_g
dim(hat_g)
length(hat_g)
?hat
hat_g <- stats::hatvalues(x)
hat_g <- stats::hatvalues(mod_g)
student_resids_g2 <- stats::rstandard(mod_g)
student_resids_g <- mod_g$residuals / (y_sigma_g * (1 - diag(hat_g)))
browser()
dim(hat_g)
length(hat_g)
student_resids_g2 <- stats::rstandard(mod_g)
student_resids_g <- mod_g$residuals / (y_sigma_g * (1 - hat_g))
plot(student_resids_g, student_resids_g2)
student_resids_g <- mod_g$residuals / sqrt(y_sigma_g * (1 - hat_g))
browser()
plot(student_resids_g, student_resids_g2)
student_resids_g <- mod_g$residuals / (y_sigma_g * sqrt(1 - hat_g))
plot(student_resids_g, student_resids_g2)
plot(hat_g)
g
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
formulaY = Y ~ X1,
comp_num = 2,
max_out = 200,
mnames = "V",
seed = 123,
print_interval = 100,
alpha = 0.5
)
ombc_p1_lcwm$outlier_num
plot(ombc_p1_lcwm$distrib_diffs, type = "l")
plot(ombc_p1$X1, ombc_p1$Y, col = ombc_p1$G + 1, pch = ombc_p1_lcwm$gmm_labels)
