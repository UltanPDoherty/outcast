colour = as.factor(labels_nE))) +
geom_point() +
labs(shape = "outlierMBC", colour = "Simulation",
title = "outlierMBC: p = 2, Model 2, Seed 1") +
ggokabeito::scale_colour_okabe_ito(order = c(9, 1:3))
scatter_ombc_p2nEm3s1 <- as.data.frame(samps_p2nE$m3$s1) |>
ggplot(aes(x = V1, y = V2,
shape = as.factor(ombc_p2nE_outs$m3_s1),
colour = as.factor(labels_nE))) +
geom_point() +
labs(shape = "outlierMBC", colour = "Simulation",
title = "outlierMBC: p = 2, Model 3, Seed 1") +
ggokabeito::scale_colour_okabe_ito(order = c(9, 1:3))
scatter_ombc_p2nEm4s1 <- as.data.frame(samps_p2nE$m4$s1) |>
ggplot(aes(x = V1, y = V2,
shape = as.factor(ombc_p2nE_outs$m4_s1),
colour = as.factor(labels_nE))) +
geom_point() +
labs(shape = "outlierMBC", colour = "Simulation",
title = "outlierMBC: p = 2, Model 4, Seed 1") +
ggokabeito::scale_colour_okabe_ito(order = c(9, 1:3))
scatter_ombc_p2nEm5s1 <- as.data.frame(samps_p2nE$m5$s1) |>
ggplot(aes(x = V1, y = V2,
shape = as.factor(ombc_p2nE_outs$m5_s1),
colour = as.factor(labels_nE))) +
geom_point() +
labs(shape = "outlierMBC", colour = "Simulation",
title = "outlierMBC: p = 2, Model 5, Seed 1") +
ggokabeito::scale_colour_okabe_ito(order = c(9, 1:3))
scatter_ombc_p2nEm1s1
scatter_ombc_p2nEm2s1
scatter_ombc_p2nEm3s1
scatter_ombc_p2nEm4s1
scatter_ombc_p2nEm5s1
ggsave(paste0(workdir, "/scatter_ombc_p2nEm1s1.png"),
scatter_ombc_p2nEm1s1,
width = 800, height = 600, units = "px")
ggsave(paste0(workdir, "/scatter_ombc_p2nEm1s1.png"),
scatter_ombc_p2nEm1s1,
width = 1600, height = 1200, units = "px")
ggsave(paste0(workdir, "/scatter_ombc_p2nEm2s1.png"),
scatter_ombc_p2nEm2s1,
width = 1600, height = 1200, units = "px")
ggsave(paste0(workdir, "/scatter_ombc_p2nEm3s1.png"),
scatter_ombc_p2nEm3s1,
width = 1600, height = 1200, units = "px")
ggsave(paste0(workdir, "/scatter_ombc_p2nEm4s1.png"),
scatter_ombc_p2nEm4s1,
width = 1600, height = 1200, units = "px")
ggsave(paste0(workdir, "/scatter_ombc_p2nEm5s1.png"),
scatter_ombc_p2nEm5s1,
width = 1600, height = 1200, units = "px")
workdir <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/oclust_replicate_0.99"
)
library(tidyverse)
labels_nE <- c(rep(1, 300), rep(2, 300), rep(3, 300), rep(0, 100))
tclust_p2nE_outs0 <- readRDS(paste0(workdir, "/tclust_p2nE_outs.rds"))
names(tclust_p2nE_outs0) <- paste0("m", 1:5)
tclust_p2nE_outs <- list_flatten(tclust_p2nE_outs0)
ombc_p2nE_outs0 <- readRDS(paste0(workdir, "/ombc_p2nE_outs.rds"))
names(ombc_p2nE_outs0) <- paste0("m", 1:5)
ombc_p2nE_outs <- list_flatten(ombc_p2nE_outs0)
ombc_p2nE_outnum <- vapply(
ombc_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(x == 1)
)
p2nE_outnum <- data.frame(
Model = rep(paste0("M", 1:5), each = 10),
seed = rep(1:10, times = 5),
Outlier_Number = ombc_p2nE_outnum
)
p2nE_outnum_gg <- p2nE_outnum |>
ggplot() +
geom_boxplot(
aes(x = Model, y = Outlier_Number, fill = Model),
show.legend = FALSE
) +
geom_hline(yintercept = 100, linetype = "dashed") +
labs(
title = "outlierMBC",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
x = "Simulation Model",
y = "Number of Outliers Identified"
)
p2nE_outnum_gg
p2nE_outnum_gg <- p2nE_outnum |>
ggplot() +
geom_boxplot(
aes(x = Model, y = Outlier_Number, fill = Model),
show.legend = FALSE
) +
geom_hline(yintercept = 100, linetype = "dashed") +
labs(
title = "outlierMBC",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
x = "Simulation Model",
y = "Number of Outliers Identified"
) +
ggokabeito::scale_colour_okabe_ito()
p2nE_outnum_gg
p2nE_outnum_gg <- p2nE_outnum |>
ggplot() +
geom_boxplot(
aes(x = Model, y = Outlier_Number, fill = Model),
show.legend = FALSE
) +
geom_hline(yintercept = 100, linetype = "dashed") +
labs(
title = "outlierMBC",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
x = "Simulation Model",
y = "Number of Outliers Identified"
) +
ggokabeito::scale_fill_okabe_ito()
p2nE_outnum_gg
p2nE_outnum_gg <- p2nE_outnum |>
ggplot() +
geom_boxplot(
aes(x = Model, y = Outlier_Number, fill = Model),
show.legend = FALSE
) +
geom_hline(yintercept = 100, linetype = "dashed") +
labs(
title = "outlierMBC",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
x = "Simulation Model",
y = "Number of Outliers Identified"
) +
ggokabeito::scale_fill_okabe_ito(order = c(4:7))
p2nE_outnum_gg
p2nE_outnum_gg <- p2nE_outnum |>
ggplot() +
geom_boxplot(
aes(x = Model, y = Outlier_Number, fill = Model),
show.legend = FALSE
) +
geom_hline(yintercept = 100, linetype = "dashed") +
labs(
title = "outlierMBC",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
x = "Simulation Model",
y = "Number of Outliers Identified"
) +
ggokabeito::scale_fill_okabe_ito(order = c(4:8))
p2nE_outnum_gg
p2nE_outnum_gg <- p2nE_outnum |>
ggplot() +
geom_boxplot(
aes(x = Model, y = Outlier_Number, fill = Model),
show.legend = FALSE
) +
geom_hline(yintercept = 100, linetype = "dashed") +
labs(
title = "outlierMBC",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
x = "Simulation Model",
y = "Number of Outliers Identified"
) +
ggokabeito::scale_fill_okabe_ito(order = c())
p2nE_outnum_gg <- p2nE_outnum |>
ggplot() +
geom_boxplot(
aes(x = Model, y = Outlier_Number, fill = Model),
show.legend = FALSE
) +
geom_hline(yintercept = 100, linetype = "dashed") +
labs(
title = "outlierMBC",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
x = "Simulation Model",
y = "Number of Outliers Identified"
) +
ggokabeito::scale_fill_okabe_ito()
p2nE_outnum_gg
ggsave(
paste0(workdir, "/p2nE_outnum.png"),
p2nE_outnum_gg,
height = 900, width = 1500, units = "px"
)
tclust_p2nE_fp <- vapply(
tclust_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE != 0 & x == 0) / 1000
)
ombc_p2nE_fp <- vapply(
ombc_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE != 0 & x == 1) / 1000
)
p2nE_fp_wide <- data.frame(
model = rep(paste0("M", 1:5), each = 10),
seed = rep(1:10, times = 5),
tclust = tclust_p2nE_fp,
ombc = ombc_p2nE_fp
)
p2nE_fp <- p2nE_fp_wide |>
pivot_longer(
cols = c("tclust", "ombc"),
values_to = "FP",
names_to = "Method"
)
tclust_p2nE_fn <- vapply(
tclust_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE == 0 & x != 0) / 1000
)
ombc_p2nE_fn <- vapply(
ombc_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE == 0 & x != 1) / 1000
)
p2nE_fn_wide <- data.frame(
model = rep(paste0("M", 1:5), each = 10),
seed = rep(1:10, times = 5),
tclust = tclust_p2nE_fn,
ombc = ombc_p2nE_fn
)
p2nE_fn <- p2nE_fn_wide |>
pivot_longer(
cols = c("tclust", "ombc"),
values_to = "FN",
names_to = "Method"
)
p2nE_mean_fpfn <- bind_cols(p2nE_fp, FN = p2nE_fn$FN) |>
group_by(model, Method) |>
summarise(FP = mean(FP), FN = mean(FN)) |>
pivot_longer(
cols = c("FP", "FN"),
names_to = "whichF", values_to = "mean_FPFN"
)
write_csv(p2nE_mean_fpfn, paste0(workdir, "/p2nE_mean_fpfn.csv"))
p2nE_mean_fpfn_stackcolumn <- p2nE_mean_fpfn |>
ggplot() +
geom_col(
aes(x = Method, y = 100 * mean_FPFN, fill = whichF),
position = "stack"
) +
facet_wrap(~model, nrow = 1) +
labs(
title = "outlierMBC vs tclust",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
fill = "Error Type",
x = "",
y = "Mean Error Percentage"
)
p2nE_mean_fpfn_stackcolumn
p2nE_mean_fpfn_stackcolumn <- p2nE_mean_fpfn |>
ggplot() +
geom_col(
aes(x = Method, y = 100 * mean_FPFN, fill = whichF),
position = "stack"
) +
facet_wrap(~model, nrow = 1) +
labs(
title = "outlierMBC vs tclust",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
fill = "Error Type",
x = "",
y = "Mean Error Percentage"
) +
ggokabeito::scale_fill_okabe_ito()
p2nE_mean_fpfn_stackcolumn
p2nE_mean_fpfn_stackcolumn <- p2nE_mean_fpfn |>
ggplot() +
geom_col(
aes(x = Method, y = 100 * mean_FPFN, fill = whichF),
position = "stack"
) +
facet_wrap(~model, nrow = 1) +
labs(
title = "outlierMBC vs tclust",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
fill = "Error Type",
x = "",
y = "Mean Error Percentage"
) +
ggokabeito::scale_fill_okabe_ito()
p2nE_mean_fpfn_stackcolumn
ggsave(
paste0(workdir, "/p2nE_mean_fpfn_stackcolumn.png"),
p2nE_mean_fpfn_stackcolumn,
height = 900, width = 1500, units = "px"
)
p2nE_fpfn <- bind_cols(p2nE_fp, FN = p2nE_fn$FN) |>
pivot_longer(
cols = c("FP", "FN"),
names_to = "whichF", values_to = "FPFN"
)
p2nE_fpfn_dodgebox <- p2nE_fpfn |>
ggplot() +
geom_boxplot(
aes(x = Method, y = 100 * FPFN, fill = whichF),
position = "dodge"
) +
facet_wrap(~model, nrow = 1) +
labs(
title = "outlierMBC vs tclust",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
fill = "Error Type",
x = "",
y = "Error Percentage"
)
p2nE_fpfn_dodgebox
p2nE_fpfn_dodgebox <- p2nE_fpfn |>
ggplot() +
geom_boxplot(
aes(x = Method, y = 100 * FPFN, fill = whichF),
position = "dodge"
) +
facet_wrap(~model, nrow = 1) +
labs(
title = "outlierMBC vs tclust",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
fill = "Error Type",
x = "",
y = "Error Percentage"
) +
ggokabeito::scale_fill_okabe_ito()
p2nE_fpfn_dodgebox
ggsave(
paste0(workdir, "/p2nE_fpfn_dodgebox.png"),
p2nE_fpfn_dodgebox,
height = 900, width = 1500, units = "px"
)
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p2nU.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nE.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nU.R")
p2nE_outnum
p2nE_outnum |>
group_by(Model) |>
summarise(Median_Outlier_Number = median(Outlier_Number))
p2nE_outnum |>
group_by(Model) |>
summarise(Minimum_Outlier_Number = min(Outlier_Number),
Median_Outlier_Number = median(Outlier_Number),
Maximum_Outlier_Number = max(Outlier_Number))
p2nU_outnum |>
group_by(Model) |>
summarise(Minimum_Outlier_Number = min(Outlier_Number),
Median_Outlier_Number = median(Outlier_Number),
Maximum_Outlier_Number = max(Outlier_Number))
p6nE_outnum |>
group_by(Model) |>
summarise(Minimum_Outlier_Number = min(Outlier_Number),
Median_Outlier_Number = median(Outlier_Number),
Maximum_Outlier_Number = max(Outlier_Number))
p6nU_outnum |>
group_by(Model) |>
summarise(Minimum_Outlier_Number = min(Outlier_Number),
Median_Outlier_Number = median(Outlier_Number),
Maximum_Outlier_Number = max(Outlier_Number))
p6nU_fpfn_dodgebox
p2nE_fp
p2nE_fpfn
p2nE_fpfn_wide <- bind_cols(p2nE_fp, FN = p2nE_fn$FN)
p2nE_fpfn_wide
tclust_p2nE_fp <- vapply(
tclust_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE != 0 & x == 0)
)
ombc_p2nE_fp <- vapply(
ombc_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE != 0 & x == 1)
)
p2nE_fp_wide <- data.frame(
model = rep(paste0("M", 1:5), each = 10),
seed = rep(1:10, times = 5),
tclust = tclust_p2nE_fp,
ombc = ombc_p2nE_fp
)
p2nE_fp <- p2nE_fp_wide |>
pivot_longer(
cols = c("tclust", "ombc"),
values_to = "FP",
names_to = "Method"
)
tclust_p2nE_fn <- vapply(
tclust_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE == 0 & x != 0)
)
ombc_p2nE_fn <- vapply(
ombc_p2nE_outs,
FUN.VALUE = double(1L),
function(x) sum(labels_nE == 0 & x != 1)
)
p2nE_fn_wide <- data.frame(
model = rep(paste0("M", 1:5), each = 10),
seed = rep(1:10, times = 5),
tclust = tclust_p2nE_fn,
ombc = ombc_p2nE_fn
)
p2nE_fn <- p2nE_fn_wide |>
pivot_longer(
cols = c("tclust", "ombc"),
values_to = "FN",
names_to = "Method"
)
bind_cols(p2nE_fp, FN = p2nE_fn$FN)
p2nE_fpfn_wide <- bind_cols(p2nE_fp, FN = p2nE_fn$FN) |>
mutate(ERR = FN + FP)
p2nE_fpfn_wide
p2nE_fpfn_median <- p2nE_fn_wide |>
group_by(model, Method) |>
summarise(FP = median(FP), FN = median(FN), medERR = median(ERR))
p2nE_fpfn_median <- p2nE_fpfn_wide |>
group_by(model, Method) |>
summarise(FP = median(FP), FN = median(FN), medERR = median(ERR))
p2nE_fpfn_median
p2nE_fpfn_median <- p2nE_fpfn_wide |>
group_by(model, Method) |>
summarise(FP = median(FP), FN = median(FN), ERR = median(ERR))
p2nE_fpfn_median_wide <- p2nE_fpfn_wide |>
group_by(model, Method) |>
summarise(FP = median(FP), FN = median(FN), ERR = median(ERR))
p2nE_fpfn_median_wide
p2nE_fpfn_median <- p2nE_fpfn_median_wide |>
pivot_longer(
cols = c("FP", "FN", "ERR"),
names_to = "Type",
values_to = "median"
)
p2nE_fpfn_median
p2nE_fpfn <- p2nE_fpfn_wide |>
pivot_longer(
cols = c("FP", "FN", "ERR"),
names_to = "Error",
values_to = "Count"
)
p2nE_fpfn_box <- p2nE_fpfn |>
ggplot() +
geom_boxplot(
aes(x = Method, y = Count, fill = Error),
position = "dodge"
) +
facet_wrap(~ model, nrow = 1) +
labs(
title = "outlierMBC vs tclust",
subtitle = "2 variables, equal proportions, 0.99 outlier level",
fill = "Error Type",
x = "",
y = "Error Percentage"
) +
ggokabeito::scale_fill_okabe_ito()
p2nE_fpfn_box
p2nE_fpfn <- p2nE_fpfn_wide |>
pivot_longer(
cols = c("FP", "FN", "Both"),
names_to = "Error",
values_to = "Count"
)
p2nE_fpfn_median_wide <- p2nE_fpfn_wide |>
group_by(model, Method) |>
summarise(FP = median(FP), FN = median(FN), Both = median(Both))
p2nE_fpfn_median_wide
p2nE_fpfn_wide <- bind_cols(p2nE_fp, FN = p2nE_fn$FN) |>
mutate(Both = FN + FP)
p2nE_fpfn_wide
p2nE_fpfn <- p2nE_fpfn_wide |>
pivot_longer(
cols = c("FP", "FN", "Both"),
names_to = "Error",
values_to = "Count"
)
p2nE_fpfn_median_wide <- p2nE_fpfn_wide |>
group_by(model, Method) |>
summarise(FP = median(FP), FN = median(FN), Both = median(Both))
p2nE_fpfn_median_wide
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p2nE.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p2nE.R")
ggsave(
paste0(workdir, "/p2nE_error_box.png"),
p2nE_error_box,
height = 900, width = 2400, units = "px"
)
ggsave(
paste0(workdir, "/p2nE_error_box.png"),
p2nE_error_box,
height = 1200, width = 2400, units = "px"
)
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p2nE.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p2nU.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nU.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nE.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nU.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nU.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p2nU.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nE.R")
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/analyse_p6nU.R")
p6nU_error_median_wide
p6nU_error_box
workdir <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/oclust_replicate_0.99"
)
samps_p2nE <- readRDS(paste0(workdir, "/samps_p2nE.rds"))
source("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/oclust_replicate_0.99/single/oclust_p2nEm1s1.R")
oclust_p2nEm1s1_time
oclust_p2nEm1s1_time[3]
oclust_p2nEm1s1_time[3] / 3600
oclust_p2nEm1s1_time[3] - 10 * 3600
oclust_p2nEm1s1_time[3] - 10 * 3600 - 48 * 60
oclust_p2nEm1s1_out$numO
plot(oclust_p2nEm1s1_out$KL)
plot(oclust_p2nEm1s1_out$KL, type = "l")
plot(oclust_p2nEm1s1_out$KL, type = "b")
plot(oclust_p2nEm1s1_out$KL, type = "l")
