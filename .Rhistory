plot(
u1n,
col = ombc_u1n_123m1000$labels + 1,
pch = ombc_u1n_123m1000$labels + 1,
main = "u1n"
)
plot(
s1,
col = mclust_s1_123m1000$classification + 1,
pch = mclust_s1_123m1000$classification + 1,
main = "s1"
)
plot(
s1n,
col = mclust_s1n_123m1000$classification + 1,
pch = mclust_s1n_123m1000$classification + 1,
main = "s1n"
)
plot(
u1,
col = mclust_u1_123m1000$classification + 1,
pch = mclust_u1_123m1000$classification + 1,
main = "u1"
)
plot(
u1n,
col = mclust_u1n_123m1000$classification + 1,
pch = mclust_u1n_123m1000$classification + 1,
main = "u1n"
)
par(mfrow = c(1, 1))
par(mfrow = c(3, 4))
palette(paletteer::paletteer_d("colorBlindness::paletteMartin"))
plot(
x = 0:1000, y = ombc_s1_123m1000$distrib_diffs, type = "l",
main = "s1", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_s1_123m1000$outlier_num)
abline(v = sum(mclust_s1_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
x = 0:1000, y = ombc_s1n_123m1000$distrib_diffs, type = "l",
main = "s1n", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_s1n_123m1000$outlier_num)
abline(v = sum(mclust_s1n_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
x = 0:1000, y = ombc_u1_123m1000$distrib_diffs, type = "l",
main = "u1", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_u1_123m1000$outlier_num)
abline(v = sum(mclust_u1_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
x = 0:1000, y = ombc_u1n_123m1000$distrib_diffs, type = "l",
main = "u1n", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_u1n_123m1000$outlier_num)
abline(v = sum(mclust_u1n_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
s1,
col = ombc_s1_123m1000$labels + 1,
pch = ombc_s1_123m1000$labels + 1,
main = "ombc_s1"
)
plot(
s1n,
col = ombc_s1n_123m1000$labels + 1,
pch = ombc_s1n_123m1000$labels + 1,
main = "ombc_s1n"
)
plot(
u1,
col = ombc_u1_123m1000$labels + 1,
pch = ombc_u1_123m1000$labels + 1,
main = "ombc_u1"
)
plot(
u1n,
col = ombc_u1n_123m1000$labels + 1,
pch = ombc_u1n_123m1000$labels + 1,
main = "ombc_u1n"
)
plot(
s1,
col = mclust_s1_123m1000$classification + 1,
pch = mclust_s1_123m1000$classification + 1,
main = "mclust_s1"
)
plot(
s1n,
col = mclust_s1n_123m1000$classification + 1,
pch = mclust_s1n_123m1000$classification + 1,
main = "mclust_s1n"
)
plot(
u1,
col = mclust_u1_123m1000$classification + 1,
pch = mclust_u1_123m1000$classification + 1,
main = "mclust_u1"
)
plot(
u1n,
col = mclust_u1n_123m1000$classification + 1,
pch = mclust_u1n_123m1000$classification + 1,
main = "mclust_u1n"
)
par(mfrow = c(1, 1))
par(mfrow = c(3, 4))
palette(paletteer::paletteer_d("colorBlindness::paletteMartin"))
plot(
x = 0:1000, y = ombc_s1_123m1000$distrib_diffs, type = "l",
main = "s1", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_s1_123m1000$outlier_num)
abline(v = sum(mclust_s1_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
x = 0:1000, y = ombc_s1n_123m1000$distrib_diffs, type = "l",
main = "s1n", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_s1n_123m1000$outlier_num)
abline(v = sum(mclust_s1n_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
x = 0:1000, y = ombc_u1_123m1000$distrib_diffs, type = "l",
main = "u1", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_u1_123m1000$outlier_num)
abline(v = sum(mclust_u1_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
x = 0:1000, y = ombc_u1n_123m1000$distrib_diffs, type = "l",
main = "u1n", ylab = "l1 mean; 1000 quantiles"
)
abline(v = ombc_u1n_123m1000$outlier_num)
abline(v = sum(mclust_u1n_123m1000$classification == 0), lty = "dashed", col = "red")
plot(
s1,
col = ombc_s1_123m1000$labels + 1,
pch = ombc_s1_123m1000$labels + 1,
main = "ombc_s1"
)
plot(
s1n,
col = ombc_s1n_123m1000$labels + 1,
pch = ombc_s1n_123m1000$labels + 1,
main = "ombc_s1n"
)
plot(
u1,
col = ombc_u1_123m1000$labels + 1,
pch = ombc_u1_123m1000$labels + 1,
main = "ombc_u1"
)
plot(
u1n,
col = ombc_u1n_123m1000$labels + 1,
pch = ombc_u1n_123m1000$labels + 1,
main = "ombc_u1n"
)
plot(
s1,
col = mclust_s1_123m1000$classification + 1,
pch = mclust_s1_123m1000$classification + 1,
main = "ombc_s1 + mclust"
)
plot(
s1n,
col = mclust_s1n_123m1000$classification + 1,
pch = mclust_s1n_123m1000$classification + 1,
main = "ombc_s1n + mclust"
)
plot(
u1,
col = mclust_u1_123m1000$classification + 1,
pch = mclust_u1_123m1000$classification + 1,
main = "ombc_u1 + mclust"
)
plot(
u1n,
col = mclust_u1n_123m1000$classification + 1,
pch = mclust_u1n_123m1000$classification + 1,
main = "ombc_u1n + mclust"
)
par(mfrow = c(1, 1))
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification)
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification)
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification)
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification)
adjustedRandIndex(u1_label, mclust_u1_123m1000$classification)
adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
adjustedRandIndex(s1_label, ombc_s1_123m1000$labels)
adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels)
adjustedRandIndex(u1_label, ombc_u1_123m1000$labels)
adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification)
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification)
adjustedRandIndex(u1_label, mclust_u1_123m1000$classification)
adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
c(
adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
)
c(
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
rbind(
c(
adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
)
bind_rows(
c(
adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
)
dplyr::bind_rows(
c(
adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
)
as.data.frame(rbind(
c(
adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
))
as.data.frame(rbind(
c(
"s1" = adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
"s1n" = adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
"u1" = adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
"u1n" = adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
"s1" = adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
"s1n" = adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
"u1" = adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
"u1n" = adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
))
dplyr::bind_rows(
c(
"s1" = adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
"s1n" = adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
"u1" = adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
"u1n" = adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
"s1" = adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
"s1n" = adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
"u1" = adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
"u1n" = adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
)
bind_cols(
method = c("ombc", "ombc + mclust"),
dplyr::bind_rows(
c(
"s1" = adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
"s1n" = adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
"u1" = adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
"u1n" = adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
"s1" = adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
"s1n" = adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
"u1" = adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
"u1n" = adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
)
)
dplyr::bind_cols(
method = c("ombc", "ombc + mclust"),
dplyr::bind_rows(
c(
"s1" = adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
"s1n" = adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
"u1" = adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
"u1n" = adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
"s1" = adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
"s1n" = adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
"u1" = adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
"u1n" = adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
)
)
ombc_mclust_ari <- dplyr::bind_cols(
method = c("ombc", "ombc + mclust"),
dplyr::bind_rows(
c(
"s1" = adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
"s1n" = adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
"u1" = adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
"u1n" = adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
"s1" = adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
"s1n" = adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
"u1" = adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
"u1n" = adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
)
)
)
ombc_mclust_ari
mclust_s1 = Mclust(X, modelNames = "VVV", G = 15)
mclust_s1 = Mclust(s1, modelNames = "VVV", G = 15)
plot(mclust_s1, what = "classification")
h = -log(as.densityMclust(mclust_s1)$density)/mclust_s1$n
(H = sum(h))  # entropy
df = data.frame(pp = ppoints(length(h)),
hi = sort(h))
plot(hi ~ pp, data = df)
abline(h = log(hypvol(mclust_s1$data))/mod$n, lty = 2, col = "indianred")
abline(h = log(hypvol(mclust_s1$data))/mclust_s1$n, lty = 2, col = "indianred")
noise = ifelse(h > log(hypvol(mclust_s1$data))/mclust_s1$n, "outlier", "inlier")
mclust_noise_s1 = Mclust(s1, initialization = list(noise = (noise == "outlier")))
clPairs(s1, noise, colors = "black", symbols = c(1,3))
entropy_noise_init <- function(mod) {
h = -log(as.densityMclust(mod)$density)/mod$n
(H = sum(h))  # entropy
df = data.frame(pp = ppoints(length(h)),
hi = sort(h))
plot(hi ~ pp, data = df)
abline(h = log(hypvol(mod$data))/mod$n, lty = 2, col = "indianred")
noise = ifelse(h > log(hypvol(mod$data))/mod$n, "outlier", "inlier")
return(noise)
}
entropy_noise_init(mclust_plain_s1)
mclust_plain_s1 = Mclust(s1, modelNames = "VVV", G = 15)
entropy_noise_init(mclust_plain_s1)
entropy_noise_init <- function(mod) {
h = -log(as.densityMclust(mod)$density)/mod$n
(H = sum(h))  # entropy
df = data.frame(pp = ppoints(length(h)),
hi = sort(h))
plot(hi ~ pp, data = df)
abline(h = log(hypvol(mod$data))/mod$n, lty = 2, col = "indianred")
noise = ifelse(h > log(hypvol(mod$data))/mod$n, "outlier", "inlier")
return(noise)
}
entropy_noise_init(mclust_plain_s1)
entropy_noise_s1 <- entropy_noise_init(mclust_plain_s1) == "outlier"
entropy_noise_s1 <- entropy_noise_init(mclust_plain_s1n) == "outlier"
set.seed(123)
mclust_plain_s1 = Mclust(s1, modelNames = "VVV", G = 15)
set.seed(123)
mclust_plain_s1n = Mclust(s1n, modelNames = "VVV", G = 15)
set.seed(123)
mclust_plain_u1 = Mclust(u1, modelNames = "VVV", G = 15)
set.seed(123)
mclust_plain_u1n = Mclust(u1n, modelNames = "VVV", G = 15)
entropy_noise_s1 <- entropy_noise_init(mclust_plain_s1) == "outlier"
entropy_noise_s1 <- entropy_noise_init(mclust_plain_s1n) == "outlier"
entropy_noise_s1 <- entropy_noise_init(mclust_plain_u1) == "outlier"
entropy_noise_s1 <- entropy_noise_init(mclust_plain_u1n) == "outlier"
entropy_noise_s1 <- entropy_noise_init(mclust_plain_s1) == "outlier"
entropy_noise_s1n <- entropy_noise_init(mclust_plain_s1n) == "outlier"
entropy_noise_u1 <- entropy_noise_init(mclust_plain_u1) == "outlier"
entropy_noise_u1n <- entropy_noise_init(mclust_plain_u1n) == "outlier"
mclust_noise_s1 = Mclust(
s1, 15, "VVV", initialization = list(noise = entropy_noise_s1)
)
mclust_noise_s1 = Mclust(
s1, 15, "VVV", initialization = list(noise = entropy_noise_s1)
)
mclust_noise_s1n = Mclust(
s1n, 15, "VVV", initialization = list(noise = entropy_noise_s1n)
)
mclust_noise_u1 = Mclust(
u1, 15, "VVV", initialization = list(noise = entropy_noise_u1)
)
mclust_noise_u1n = Mclust(
u1n, 15, "VVV", initialization = list(noise = entropy_noise_u1n)
)
ombc_mclust_ari <- dplyr::bind_cols(
method = c("ombc", "ombc + mclust", "mclust entropy"),
dplyr::bind_rows(
c(
"s1" = adjustedRandIndex(s1_label, ombc_s1_123m1000$labels),
"s1n" = adjustedRandIndex(s1n_label, ombc_s1n_123m1000$labels),
"u1" = adjustedRandIndex(u1_label, ombc_u1_123m1000$labels),
"u1n" = adjustedRandIndex(u1n_label, ombc_u1n_123m1000$labels)
),
c(
"s1" = adjustedRandIndex(s1_label, mclust_s1_123m1000$classification),
"s1n" = adjustedRandIndex(s1n_label, mclust_s1n_123m1000$classification),
"u1" = adjustedRandIndex(u1_label, mclust_u1_123m1000$classification),
"u1n" = adjustedRandIndex(u1n_label, mclust_u1n_123m1000$classification)
),
c(
"s1" = adjustedRandIndex(s1_label, mclust_noise_s1$classification),
"s1n" = adjustedRandIndex(s1n_label, mclust_noise_s1n$classification),
"u1" = adjustedRandIndex(u1_label, mclust_noise_u1$classification),
"u1n" = adjustedRandIndex(u1n_label, mclust_noise_u1n$classification)
)
)
)
ombc_mclust_ari
entropy_noise_s1 <- entropy_noise_init(mclust_plain_s1) == "outlier"
entropy_noise_s1n <- entropy_noise_init(mclust_plain_s1n) == "outlier"
entropy_noise_u1 <- entropy_noise_init(mclust_plain_u1) == "outlier"
plot(s1n_label)
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/9dataset_comparison"
)
s1 <- read.table(
paste0(folder, "/uef_sipu_data/s1.txt")
)
s1_var_num <- ncol(s1)
s1_obs_num <- nrow(s1)
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/9dataset_comparison"
)
s1 <- read.table(
paste0(folder, "/uef_sipu_data/s1.txt")
)
s1_var_num <- ncol(s1)
s1_obs_num <- nrow(s1)
s1_noise_num <- round(0.07 * s1_obs_num)
s1_mean <- s1_spread <- s1_noise_mins <- s1_noise_maxs <- c()
s1_noise <- matrix(nrow = s1_noise_num, ncol = s1_var_num)
set.seed(123)
for (p in seq_len(ncol(s1))) {
s1_mean[p] <- mean(s1[, p])
s1_spread[p] <- max(
c(abs(min(s1[, p]) - s1_mean[p]), abs(min(s1[, p]) - s1_mean[p]))
)
s1_noise_mins[p] <- s1_mean[p] - 2 * s1_spread[p]
s1_noise_maxs[p] <- s1_mean[p] + 2 * s1_spread[p]
s1_noise[, p] <- runif(s1_noise_num, s1_noise_mins[p], s1_noise_maxs[p])
}
s1n <- rbind(s1, as.data.frame(s1_noise))
s1_label <- read.table(
paste0(folder, "/uef_sipu_data/s-originals/s1-label.pa"), skip = 5
) |> dplyr::pull()
s1n_label <- c(s1_label, rep(0, s1_noise_num))
s1_list <- split(s1, s1_label)
s1_means <- lapply(s1_list, colMeans)
s1_covariances <- lapply(s1_list, cov)
s1_counts <- as.numeric(table(s1_label))
set.seed(123)
u1 <- matrix(nrow = 0, ncol = 2)
for (k in 1:15) {
u1 <- rbind(u1, mvtnorm::rmvnorm(
n = s1_counts[k],
mean = s1_means[[k]],
sigma = s1_covariances[[k]]
))
}
u1 <- as.data.frame(u1)
u1n <- rbind(u1, s1_noise)
u1_label <- rep(1:15, s1_counts)
u1n_label <- c(u1_label, rep(0, 350))
palette(paletteer::paletteer_d("colorBlindness::paletteMartin"))
par(mfrow = c(2, 2))
plot(s1, col = s1_label + 1, pch = s1_label + 1, main = "s1")
plot(s1n, col = s1n_label + 1, pch = s1n_label + 1, main = "s1n")
plot(u1, col = u1_label + 1, pch = u1_label + 1, main = "u1")
plot(u1n, col = u1n_label + 1, pch = u1n_label + 1, main = "u1n")
par(mfrow = c(1, 1))
ombc_s1n_123m5000_time <- system.time({
ombc_s1n_123m5000 <- ombc_gmm(
x = s1n,
comp_num = 15,
max_out = 5000,
mnames = "VVV",
seed = 123,
reinit_interval = 100,
print_interval = 100
)
})
