main = "opt2: l1, increments"
)
plot(
s1g1, col = ombc_s1g1_opt3$labels + 1,
main = "opt3: l2, increments"
)
plot(
s1g1, col = ombc_s1g1_opt4$labels + 1,
main = "opt4: l2"
)
plot(
s1g1, col = ombc_s1g1_opt5$labels + 1,
main = "opt5: kl"
)
plot(
s1g1, col = ombc_s1g1_opt6$labels + 1,
main = "opt6: ks"
)
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
par(mfrow = c(2, 6))
plot(
x = 0:80, y = ombc_gmm_opt1$distrib_diffs, type = "l",
main = "opt1: l1"
)
abline(v = ombc_gmm_opt1$outlier_num)
plot(
x = 0:80, y = ombc_gmm_opt2$distrib_diffs, type = "l",
main = "opt2: l1, increments"
)
abline(v = ombc_gmm_opt2$outlier_num)
plot(
x = 0:80, y = ombc_gmm_opt3$distrib_diffs, type = "l",
main = "opt3: l2, increments"
)
abline(v = ombc_gmm_opt3$outlier_num)
plot(
x = 0:80, y = ombc_gmm_opt4$distrib_diffs, type = "l",
main = "opt4: l2"
)
abline(v = ombc_gmm_opt4$outlier_num)
plot(
x = 0:80, y = ombc_gmm_opt5$distrib_diffs, type = "l",
main = "opt5: kl"
)
abline(v = ombc_gmm_opt5$outlier_num)
plot(
x = 0:80, y = ombc_gmm_opt6$distrib_diffs, type = "l",
main = "opt6: ks"
)
abline(v = ombc_gmm_opt6$outlier_num)
plot(
gmm[, 1:2], col = ombc_gmm_opt1$labels + 1,
main = "opt1: l1"
)
plot(
gmm[, 1:2], col = ombc_gmm_opt2$labels + 1,
main = "opt2: l1, increments"
)
plot(
gmm[, 1:2], col = ombc_gmm_opt3$labels + 1,
main = "opt3: l2, increments"
)
plot(
gmm[, 1:2], col = ombc_gmm_opt4$labels + 1,
main = "opt4: l2"
)
plot(
gmm[, 1:2], col = ombc_gmm_opt5$labels + 1,
main = "opt5: kl"
)
plot(
gmm[, 1:2], col = ombc_gmm_opt5$labels + 1,
main = "opt6: ks"
)
load_all()
set.seed(123)
x1 <- mvtnorm::rmvnorm(100, mean = c(0, 0))
set.seed(123)
x2 <- rbind(x1, cbind(runif(20, -3.75, 3.75), runif(20, -3.75, 3.75)))
set.seed(123)
x3 <- mvtnorm::rmvt(100, df = 3)
par(mfrow = c(1, 3))
plot(x1, pch = 20, xlim = c(-3.5, 3.5), ylim = c(-3.5, 3.5), main = "N")
plot(x2, col = rep(1:2, c(100, 20)), pch = 20, xlim = c(-3.5, 3.5), ylim = c(-3.5, 3.5), main = "N+U")
plot(x3, pch = 20, xlim = c(-1, 1) * max(abs(x3[, 1])), ylim = c(-1, 1) * max(abs(x3[, 2])), main = "t")
par(mfrow = c(1, 1))
M <- 50
ombc_x1opt1 <- ombc_gmm(
x = x1,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x2opt1 <- ombc_gmm(
x = x2,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x3opt1 <- ombc_gmm(
x = x3,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
load_all()
ombc_x1opt2 <- ombc_gmm(
x = x1,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x2opt2 <- ombc_gmm(
x = x2,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x3opt2 <- ombc_gmm(
x = x3,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
load_all()
ombc_x1opt3 <- ombc_gmm(
x = x1,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x2opt3 <- ombc_gmm(
x = x2,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x3opt3 <- ombc_gmm(
x = x3,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
load_all()
ombc_x1opt4 <- ombc_gmm(
x = x1,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x2opt4 <- ombc_gmm(
x = x2,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x3opt4 <- ombc_gmm(
x = x3,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
load_all()
ombc_x1opt5 <- ombc_gmm(
x = x1,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x2opt5 <- ombc_gmm(
x = x2,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x3opt5 <- ombc_gmm(
x = x3,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
load_all()
ombc_x1opt6 <- ombc_gmm(
x = x1,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x2opt6 <- ombc_gmm(
x = x2,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
ombc_x3opt6 <- ombc_gmm(
x = x3,
comp_num = 1,
max_out = M,
mnames = "VVV",
seed = 123,
reinit_interval = Inf
)
par(mfrow = c(3, 6))
plot(x = 0:M, y = ombc_x1opt1$distrib_diffs, type = "l", main = "N - cdf l1")
abline(v = ombc_x1opt1$outlier_num)
plot(x = 0:M, y = ombc_x1opt2$distrib_diffs, type = "l", main = "N - pmf l1")
abline(v = ombc_x1opt2$outlier_num)
plot(x = 0:M, y = ombc_x1opt3$distrib_diffs, type = "l", main = "N - pmf l2")
abline(v = ombc_x1opt3$outlier_num)
plot(x = 0:M, y = ombc_x1opt4$distrib_diffs, type = "l", main = "N - cdf l2")
abline(v = ombc_x1opt4$outlier_num)
plot(x = 0:M, y = ombc_x1opt5$distrib_diffs, type = "l", main = "N - q cdf kl")
abline(v = ombc_x1opt5$outlier_num)
plot(x = 0:M, y = ombc_x1opt6$distrib_diffs, type = "l", main = "N - ks")
abline(v = ombc_x1opt6$outlier_num)
plot(x = 0:M, y = ombc_x2opt1$distrib_diffs, type = "l", main = "N+U - cdf l1")
abline(v = ombc_x2opt1$outlier_num)
plot(x = 0:M, y = ombc_x2opt2$distrib_diffs, type = "l", main = "N+U - pmf l1")
abline(v = ombc_x2opt2$outlier_num)
plot(x = 0:M, y = ombc_x2opt3$distrib_diffs, type = "l", main = "N+U - pmf l2")
abline(v = ombc_x2opt3$outlier_num)
plot(x = 0:M, y = ombc_x2opt4$distrib_diffs, type = "l", main = "N+U - cdf l2")
abline(v = ombc_x2opt4$outlier_num)
plot(x = 0:M, y = ombc_x2opt5$distrib_diffs, type = "l", main = "N+U - q cdf kl")
abline(v = ombc_x2opt5$outlier_num)
plot(x = 0:M, y = ombc_x2opt6$distrib_diffs, type = "l", main = "N+U - ks")
abline(v = ombc_x2opt6$outlier_num)
plot(x = 0:M, y = ombc_x3opt1$distrib_diffs, type = "l", main = "t - cdf l1")
abline(v = ombc_x3opt1$outlier_num)
plot(x = 0:M, y = ombc_x3opt2$distrib_diffs, type = "l", main = "t - pmf l1")
abline(v = ombc_x3opt2$outlier_num)
plot(x = 0:M, y = ombc_x3opt3$distrib_diffs, type = "l", main = "t - pmf l2")
abline(v = ombc_x3opt3$outlier_num)
plot(x = 0:M, y = ombc_x3opt4$distrib_diffs, type = "l", main = "t - cdf l2")
abline(v = ombc_x3opt4$outlier_num)
plot(x = 0:M, y = ombc_x3opt5$distrib_diffs, type = "l", main = "t - q cdf kl")
abline(v = ombc_x3opt5$outlier_num)
plot(x = 0:M, y = ombc_x3opt6$distrib_diffs, type = "l", main = "t - ks")
abline(v = ombc_x3opt6$outlier_num)
par(mfrow = c(1, 1))
load_all()
comp_num <- 3
n_vec <- c(1000, 1000, 1000)
label_vec <- rep(seq_len(comp_num), n_vec)
mu_list <- list(c(-15, 0), c(+15, 0), c(0, 0))
sigma_list <- list(
diag(c(1, 1)),
diag(c(0.5, 2)),
rbind(c(1, -0.75), c(-0.75, 1))
)
t_df <- 5
set.seed(123)
gmm1 <- Reduce(
rbind,
lapply(
seq_len(comp_num),
function(x) mvtnorm::rmvnorm(
n_vec[x], mu_list[[x]], sigma_list[[x]]
)
)
)
set.seed(123)
tmm1 <- Reduce(
rbind,
lapply(
seq_len(comp_num),
function(x) mvtnorm::rmvt(
n_vec[x], sigma_list[[x]] * (1 - 2 / t_df), t_df, mu_list[[x]]
)
)
)
plot(gmm1, col = label_vec, asp = 1, ylim = c(-10, 10))
plot(tmm1, col = label_vec, asp = 1, ylim = c(-10, 10))
M <- 300
ombc_gmm1 <- ombc_gmm(gmm1, comp_num, M, print_interval = 5)
ombc_tmm1 <- ombc_gmm(tmm1, comp_num, M, print_interval = 5)
palette(ggokabeito::palette_okabe_ito(order = c(9, 1:8)))
par(mfrow = c(2, 2))
plot(seq(0, M), ombc_gmm1$distrib_diffs, type = "l", main = "gmm1")
abline(v = ombc_gmm1$outlier_num)
plot(gmm1, col = ombc_gmm1$labels + 1, pch = label_vec, main = "gmm1", asp = 1, ylim = c(-10, 10))
plot(seq(0, M), ombc_tmm1$distrib_diffs, type = "l", main = "tmm1")
abline(v = ombc_tmm1$outlier_num)
plot(tmm1, col = ombc_tmm1$labels + 1, pch = label_vec, main = "tmm1", asp = 1, ylim = c(-10, 10))
# ------------------------------------------------------------------------------
old_ombc_s1_123m500 <- ombc_s1_123m500
ombc_s1_123m500_time <- system.time({
ombc_s1_123m500 <- ombc_gmm(
x = s1,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
ombc_s1n_123m500_time <- system.time({
ombc_s1n_123m500 <- ombc_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
par(mfrow = c(2, 2))
plot(x = 0:500, y = ombc_s1_123m500$distrib_diffs, type = "l", main = "s1", ylab = "l2 pmf")
abline(v = ombc_s1_123m500$outlier_num)
abline(v = c(370, 420, 440), col = "blue", lty = "dashed")
plot(s1, col = ombc_s1_123m500$labels + 1, pch = ombc_s1_123m500$labels + 1, main = "s1")
plot(x = 0:500, y = ombc_s1n_123m500$distrib_diffs, type = "l", main = "s1 + 350 uniform", ylab = "l2 pmf")
abline(v = ombc_s1n_123m500$outlier_num)
abline(v = c(10, 20, 50, 60, 110, 280), col = "blue", lty = "dashed")
plot(s1n, col = ombc_s1n_123m500$labels + 1, pch = ombc_s1n_123m500$labels + 1, main = "s1 + 350 uniform")
par(mfrow = c(1, 1))
plot(x = 0:500, y = ombc_s1n_123m500$distrib_diffs, type = "l", main = "s1 + 350 uniform", ylab = "l2 pmf")
abline(v = ombc_s1n_123m500$outlier_num)
abline(v = c(10, 20, 60, 100, 110, 260, 280, 420), col = "blue", lty = "dashed")
plot(s1n, col = ombc_s1n_123m500$labels + 1, pch = ombc_s1n_123m500$labels + 1, main = "s1 + 350 uniform")
par(mfrow = c(2, 2))
plot(x = 0:500, y = ombc_s1_123m500$distrib_diffs, type = "l", main = "s1", ylab = "l2 pmf")
abline(v = ombc_s1_123m500$outlier_num)
abline(v = c(370, 420, 440), col = "blue", lty = "dashed")
plot(s1, col = ombc_s1_123m500$labels + 1, pch = ombc_s1_123m500$labels + 1, main = "s1")
plot(x = 0:500, y = ombc_s1n_123m500$distrib_diffs, type = "l", main = "s1 + 350 uniform", ylab = "l2 pmf")
abline(v = ombc_s1n_123m500$outlier_num)
abline(v = c(10, 20, 60, 100, 110, 260, 280, 420), col = "blue", lty = "dashed")
plot(s1n, col = ombc_s1n_123m500$labels + 1, pch = ombc_s1n_123m500$labels + 1, main = "s1 + 350 uniform")
par(mfrow = c(1, 1))
s1_list <- split(s1, s1_label)
s1_means <- lapply(s1_list, colMeans)
s1_covariances <- lapply(s1_list, cov)
s1_counts <- as.numeric(table(s1_label))
set.seed(123)
u1 <- matrix(nrow = 0, ncol = 2)
for (k in 1:15) {
u1 <- rbind(u1, mvtnorm::rmvnorm(
n = s1_counts[k],
mean = s1_means[[k]],
sigma = s1_covariances[[k]]
))
}
u1 <- as.data.frame(u1)
u1n <- rbind(u1, s1_noise)
u1_label <- rep(1:15, s1_counts)
u1n_label <- c(u1_label, rep(0, 350))
palette(paletteer::paletteer_d("colorBlindness::paletteMartin", 15))
par(mfrow = c(1, 1))
plot(s1, col = 1 + s1_label, pch = 1 + s1_label, main = "s1")
plot(s1n, col = 1 + s1n_label, pch = 1 + s1n_label, main = "s1n")
par(mfrow = c(1, 2))
plot(s1n, col = 1 + s1n_label, pch = 1 + s1n_label, main = "s1n")
plot(u1n, col = 1 + u1n_label, pch = 1 + u1n_label, main = "u1n")
ombc_u1n <- ombc_gmm(
x = u1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
saveRDS(ombc_u1n, paste0(folder, "/outlierMBC_demos/ombc_u1n_maxout500.rds"))
saveRDS(ombc_u1n, paste0(folder, "/outlierMBC/ombc_u1n_maxout500.rds"))
plot(
x = 0:500, y = ombc_u1n$distrib_diffs, type = "l",
main = "u1 with outliers; max_out = 500; reinit_interval = 10 (km++)"
)
abline(v = c(10, 20, 40, 60, 70, 90, ) - 1, col = "blue", lty = "dashed")
abline(v = c(10, 20, 40, 60, 70, 90, 180, 270) - 1, col = "blue", lty = "dashed")
abline(v = ombc_u1n$outlier_num)
plot(
u1n, col = ombc_u1n$labels + 1, pch = ombc_u1n$labels + 1,
main = "u1 with outliers; max_out = 500; reinit_interval = 10 (km++)"
)
plot(
x = 0:500, y = ombc_u1n$distrib_diffs, type = "l",
main = "u1n"
)
abline(v = c(10, 20, 40, 60, 70, 90, 180, 270) - 1, col = "blue", lty = "dashed")
abline(v = ombc_u1n$outlier_num)
plot(
u1n, col = ombc_u1n$labels + 1, pch = ombc_u1n$labels + 1,
main = "u1n"
)
matplot(x = 0:500, y = ombc_s1_123m500$distrib_diff_mat, type = "l", col = "black", lty = "solid")
par(mfrow = c(1, 1))
matplot(x = 0:500, y = ombc_s1_123m500$distrib_diff_mat, type = "l", col = "black", lty = "solid")
lines(x = 0:500, y = ombc_s1_123m500$distrib_diffs, col = "red", lwd = 2)
plot(x = 0:500, y = ombc_s1_123m500$distrib_diffs, type = "l", main = "s1", ylab = "l2 pmf")
abline(v = ombc_s1_123m500$outlier_num)
abline(v = c(370, 420, 440), col = "blue", lty = "dashed")
plot(s1, col = ombc_s1_123m500$labels + 1, pch = ombc_s1_123m500$labels + 1, main = "s1")
matplot(x = 0:500, y = ombc_s1_123m500$distrib_diff_mat, type = "l", col = "black", lty = "solid")
lines(x = 0:500, y = ombc_s1_123m500$distrib_diffs, col = "red", lwd = 2)
matplot(x = 0:500, y = ombc_s1n_123m500$distrib_diff_mat, type = "l", col = "black", lty = "solid")
lines(x = 0:500, y = ombc_s1n_123m500$distrib_diffs, col = "red", lwd = 2)
s1n_glosh <- dbscan::glosh(s1, 15)
plot(s1n_glosh)
plot(sort(s1n_glosh))
plot(sort(s1n_glosh), type = "l")
plot(sort(s1n_glosh)^2)
plot(sort(s1n_glosh)^2, type = "l")
plot(sort(s1n_glosh)^3, type = "l")
s1n_glosh_sort <- sort(s1n_glosh)
plot(s1n_glosh_sort, type = "l")
lines(s1n_glosh_sort^2)
lines(s1n_glosh_sort^2)
lines(s1n_glosh_sort^3)
lines(s1n_glosh_sort^4)
sum(s1n_glosh_sort^2 > 0.99)
sum(s1n_glosh_sort^2 > 0.9)
sum(s1n_glosh_sort > 0.99)
sum(s1n_glosh_sort > 0.9)
sum(s1n_glosh_sort > 0.95)
plot(s1n_glosh_sort, type = "b")
plot(s1n_glosh_sort[4850:5350], type = "b")
plot(0:500, s1n_glosh_sort[4850:5350], type = "b")
plot(x = 0:500, y = s1n_glosh_sort[4850:5350], type = "b")
plot(x = 0:500, y = s1n_glosh_sort[4850:5350], type = "b")
head(s1n_glosh_sort[4850:5350])
length(s1n_glosh_sort[4850:5350])
plot(x = 0:500, y = s1n_glosh_sort[4850:5350], type = "b")
plot(cbind(0:500, s1n_glosh_sort[4850:5350]), type = "b")
plot(cbind(0:500, s1n_glosh_sort[4850:5350]), type = "l")
length(unique(s1n_glosh_sort))
length(unique(s1n_glosh_sort[4850:5350]))
plot(s1n_glosh_sort)
s1n_glosh <- dbscan::glosh(s1n, 15)
s1n_glosh_sort <- sort(s1n_glosh)
plot(s1n_glosh_sort)
plot(cbind(0:500, s1n_glosh_sort[4850:5350]), type = "l")
lines(s1n_glosh_sort^3)
lines(s1n_glosh_sort^4)
sum(s1n_glosh_sort > 0.99)
abline(h = 0.99)
abline(h = c(0.990, 0.991, 0.992, 0.993, 0.994))
abline(h = 0.993)
plot(cbind(0:500, s1n_glosh_sort[4850:5350]), type = "l")
abline(h = 0.993)
sum(s1n_glosh_sort > 0.993)
abline(h = 0.995)
sum(s1n_glosh_sort > 0.995)
s1n2 <- s1n[rank(1 - s1n_glosh) > 200, ]
plot(s1n2)
s1n2_label <- s1n_label[rank(1 - s1n_glosh) > 200]
plot(s1n2)
plot(s1n2, col = s1n2_label)
plot(s1n2, col = s1n2_label + 1)
plot(s1n2, col = s1n2_label + 1, pch = s1n2_label + 1)
ombc_s1n2_123_time <- system.time({
ombc_s1n2_123 <- ombc_gmm(
x = s1n2,
comp_num = 15,
max_out = 300,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
plot(x = 0:300, y = ombc_s1n2_123$distrib_diffs, type = "l")
abline(v = ombc_s1n2_123$outlier_num)
plot(x = 0:300, y = ombc_s1n2_123$distrib_diffs, type = "l")
abline(v = ombc_s1n2_123$outlier_num)
palette(paletteer::paletteer_d("colorBlindness::paletteMartin"))
plot(s1n2, col = ombc_s1n2_123$labels + 1, pch = ombc_s1n2_123$labels + 1)
