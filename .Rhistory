document()
check()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
y_formula = Y ~ X1,
comp_num = 2,
max_out = 100,
mnames = "V",
seed = 123,
print_interval = Inf,
alpha = 0.5
)
plot(x = seq_len(101), y = ombc_p1_lcwm$distrib_diffs, type = "l")
abline(v = ombc_p1_lcwm$outlier_num)
plot(
ombc_p1[, c("X1", "Y")], pch = ombc_p1$G + 1, col = ombc_p1_lcwm$labels
)
ombc_p1 |>
mutate(ombc = as.factor(ombc_p1_lcwm$labels - 1), G = as.factor(G)) |>
ggplot(aes(x = X1, y = Y, colour = ombc, shape = G)) +
geom_point() +
ggokabeito::scale_colour_okabe_ito() +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(intercept = 1, slope = 0)) +
geom_abline(aes(intercept = 1, slope = 3)) +
labs(
title = "outlierMBC: Simulated Cluster-Weighted Model Demo",
subtitle = "Solid Lines - True, Dashed Lines - Estimated"
)
ombc_p1 |>
mutate(ombc = as.factor(ombc_p1_lcwm$labels - 1), G = as.factor(G)) |>
mutate(comparison = case_when(
G == 0 & ombc == 0 ~ "TP",
G == 0 & ombc != 0 ~ "FN",
G != 0 & ombc == 0 ~ "FP",
G != 0 & ombc != 0 ~ "TN",
)) |>
ggplot(aes(x = X1, y = Y, colour = comparison, shape = G)) +
geom_point() +
ggokabeito::scale_colour_okabe_ito(order = c(1, 3, 5, 7)) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(intercept = 1, slope = 0)) +
geom_abline(aes(intercept = 1, slope = 3)) +
labs(
title = "outlierMBC: Simulated Cluster-Weighted Model Demo",
subtitle = "Solid Lines - Simulation, Dashed Lines - Estimated",
colour = "outlierMBC"
)
ombc_p1 |>
mutate(ombc = as.factor(ombc_p1_lcwm$labels - 1), G = as.factor(G)) |>
mutate(comparison = case_when(
G == 0 & ombc == 0 ~ "TP",
G == 0 & ombc != 0 ~ "FN",
G != 0 & ombc == 0 ~ "FP",
G != 0 & ombc != 0 ~ "TN",
)) |>
ggplot(aes(x = X1, y = Y, colour = comparison, shape = G)) +
geom_point() +
ggokabeito::scale_colour_okabe_ito(order = c(1, 3, 5, 7)) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(intercept = 1, slope = 0)) +
geom_abline(aes(intercept = 1, slope = 3)) +
labs(
title = "ombc_lcwm: outlierMBC Linear CWM",
subtitle = "Solid Lines - Simulation, Dashed Lines - Estimated",
colour = "outlierMBC"
)
ombc_p1_flexcwm <- flexCWM::cwm(
Y ~ X1,
data = ombc_p1, Xnorm = ombc_p1$X1, modelXnorm = "V", k = 2,
initialization = "kmeans", seed = 123
)
ombc_p1_flexcwm$models[[1]]$GLModel$comp.1$model$coefficients
ombc_p1 |>
mutate(ombc = as.factor(ombc_p1_lcwm$labels - 1), G = as.factor(G)) |>
mutate(comparison = case_when(
G == 0 & ombc == 0 ~ "TP",
G == 0 & ombc != 0 ~ "FN",
G != 0 & ombc == 0 ~ "FP",
G != 0 & ombc != 0 ~ "TN",
)) |>
ggplot(aes(x = X1, y = Y, colour = comparison, shape = G)) +
geom_point() +
ggokabeito::scale_colour_okabe_ito(order = c(1, 3, 5, 7)) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_flexcwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_flexcwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dotted"
) +
geom_abline(aes(
intercept = ombc_p1_flexcwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_flexcwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dotted"
) +
geom_abline(aes(intercept = 1, slope = 0)) +
geom_abline(aes(intercept = 1, slope = 3)) +
labs(
title = "ombc_lcwm: outlierMBC Linear CWM",
subtitle = "Solid Lines - Simulation, Dashed Lines - Estimated",
colour = "outlierMBC"
)
ombc_p1 |>
mutate(ombc = as.factor(ombc_p1_lcwm$labels - 1), G = as.factor(G)) |>
mutate(comparison = case_when(
G == 0 & ombc == 0 ~ "TP",
G == 0 & ombc != 0 ~ "FN",
G != 0 & ombc == 0 ~ "FP",
G != 0 & ombc != 0 ~ "TN",
)) |>
ggplot(aes(x = X1, y = Y, colour = comparison, shape = G)) +
geom_point() +
ggokabeito::scale_colour_okabe_ito(order = c(1, 3, 5, 7)) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(intercept = 1, slope = 0)) +
geom_abline(aes(intercept = 1, slope = 3)) +
labs(
title = "ombc_lcwm: outlierMBC Linear CWM",
subtitle = "Solid Lines - Simulation, Dashed Lines - Estimated",
colour = "outlierMBC"
)
noisy_mlr_p1 <- simulate_noisy_mlr(
n = 1000,
mu = +1,
sigma = as.matrix(0.1),
beta = c(1, 1),
error_sd = 0.5,
outlier_num = 20, seed = 123,
crit_val = 0.9999
)
ombc_mlr_p1 <- ombc_mlr(
noisy_mlr_p1$covariates,
noisy_mlr_p1$responses,
max_out = 40
)
par(mfrow = c(1, 2))
plot(0:40, ombc_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_mlr_p1$outlier_bool
)
data.frame(noisy_mlr_p1)
?ombc_lcwm
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ covariates,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
head(data.frame(noisy_mlr_p1))
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
par(mfrow = c(1, 2))
plot(0:40, ombc_lcwm_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_lcwm_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_lcwm_mlr_p1$outlier_bool
)
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
plot(0:40, ombc_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_mlr_p1$outlier_bool
)
plot(0:40, ombc_lcwm_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_lcwm_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_lcwm_mlr_p1$outlier_bool
)
par(mfrow = c(1, 1))
ombc_lcwm_mlr_p1$outlier_num
ombc_lcwm_mlr_p1$outlier_num == ombc_mlr_p1$outlier_num
sum(ombc_lcwm_mlr_p1$distrib_diffs == ombc_mlr_p1$distrib_diffs)
sum(ombc_lcwm_mlr_p1$outlier_rank == ombc_mlr_p1$outlier_rank)
sum(ombc_lcwm_mlr_p1$distrib_diffs != ombc_mlr_p1$distrib_diffs)
sum(ombc_lcwm_mlr_p1$outlier_rank != ombc_mlr_p1$outlier_rank)
max(ombc_lcwm_mlr_p1$distrib_diffs - ombc_mlr_p1$distrib_diffs)
plot(x = seq_len(101), y = ombc_p1_lcwm$distrib_diffs, type = "l")
abline(v = ombc_p1_lcwm$outlier_num)
load_all()
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
df_g
load_all()
ombc_mlr_p1 <- ombc_mlr(
noisy_mlr_p1$covariates,
noisy_mlr_p1$responses,
max_out = 40
)
lm_mod$df.residual
load_all()
ombc_mlr_p1 <- ombc_mlr(
noisy_mlr_p1$covariates,
noisy_mlr_p1$responses,
max_out = 40
)
distrib_diff
student_resids
plot()
plot(student_resids)
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
plot(student_resids_g)
head(distrib_diff)
head(distrib_diff_g_y)
ombc_mlr_p1 <- ombc_mlr(
noisy_mlr_p1$covariates,
noisy_mlr_p1$responses,
max_out = 40
)
head(distrib_diff)
load_all()
ombc_mlr_p1 <- ombc_mlr(
noisy_mlr_p1$covariates,
noisy_mlr_p1$responses,
max_out = 40
)
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
par(mfrow = c(2, 2))
plot(0:40, ombc_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_mlr_p1$outlier_bool
)
plot(0:40, ombc_lcwm_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_lcwm_mlr_p1$outlier_num)
min(ombc_lcwm_mlr_p1$distrib_diffs - ombc_mlr_p1$distrib_diffs)
load_all()
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
prop
load_all()
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
y_formula = Y ~ X1,
comp_num = 2,
max_out = 100,
mnames = "V",
seed = 123,
print_interval = Inf,
alpha = 0.5
)
load_all()
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
prop
nrow(x)
load_all()
ombc_p1_lcwm <- ombc_lcwm(
xy = ombc_p1[, -3],
x = ombc_p1$X1,
y_formula = Y ~ X1,
comp_num = 2,
max_out = 100,
mnames = "V",
seed = 123,
print_interval = Inf,
alpha = 0.5
)
plot(x = seq_len(101), y = ombc_p1_lcwm$distrib_diffs, type = "l")
par(mfrow = c(1, 1))
plot(x = seq_len(101), y = ombc_p1_lcwm$distrib_diffs, type = "l")
abline(v = ombc_p1_lcwm$outlier_num)
plot(
ombc_p1[, c("X1", "Y")], pch = ombc_p1$G + 1, col = ombc_p1_lcwm$labels
)
ombc_p1 |>
mutate(ombc = as.factor(ombc_p1_lcwm$labels - 1), G = as.factor(G)) |>
ggplot(aes(x = X1, y = Y, colour = ombc, shape = G)) +
geom_point() +
ggokabeito::scale_colour_okabe_ito() +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(intercept = 1, slope = 0)) +
geom_abline(aes(intercept = 1, slope = 3)) +
labs(
title = "outlierMBC: Simulated Cluster-Weighted Model Demo",
subtitle = "Solid Lines - True, Dashed Lines - Estimated"
)
ombc_p1 |>
mutate(ombc = as.factor(ombc_p1_lcwm$labels - 1), G = as.factor(G)) |>
mutate(comparison = case_when(
G == 0 & ombc == 0 ~ "TP",
G == 0 & ombc != 0 ~ "FN",
G != 0 & ombc == 0 ~ "FP",
G != 0 & ombc != 0 ~ "TN",
)) |>
ggplot(aes(x = X1, y = Y, colour = comparison, shape = G)) +
geom_point() +
ggokabeito::scale_colour_okabe_ito(order = c(1, 3, 5, 7)) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.1$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(
intercept = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[1],
slope = ombc_p1_lcwm$final_cwm$models[[1]]$GLModel$comp.2$model$coefficients[2]),
linetype = "dashed"
) +
geom_abline(aes(intercept = 1, slope = 0)) +
geom_abline(aes(intercept = 1, slope = 3)) +
labs(
title = "ombc_lcwm: outlierMBC Linear CWM",
subtitle = "Solid Lines - Simulation, Dashed Lines - Estimated",
colour = "outlierMBC"
)
ombc_p1_flexcwm <- flexCWM::cwm(
Y ~ X1,
data = ombc_p1, Xnorm = ombc_p1$X1, modelXnorm = "V", k = 2,
initialization = "kmeans", seed = 123
)
ombc_p1_flexcwm_resids <-
(ombc_p1_flexcwm$models[[1]]$posterior[, 1] * ombc_p1_flexcwm$models[[1]]$GLModel$comp.1$model$residuals
+ ombc_p1_flexcwm$models[[1]]$posterior[, 2] * ombc_p1_flexcwm$models[[1]]$GLModel$comp.2$model$residuals)
plot(x = ombc_p1$X1, y = ombc_p1_flexcwm_resids,
col = ombc_p1_lcwm$labels,
pch = ombc_p1$G + 1,
xlab = "X1", ylab = "Mixture Residuals")
ombc_lcwm_mlr_p1 <- ombc_lcwm(
xy = data.frame(noisy_mlr_p1),
x = noisy_mlr_p1$covariates,
y_formula = responses ~ V1,
comp_num = 1,
max_out = 40,
mnames = "V",
seed = 123,
outlier_type = "y_only"
)
par(mfrow = c(2, 2))
plot(0:40, ombc_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_mlr_p1$outlier_bool
)
plot(0:40, ombc_lcwm_mlr_p1$distrib_diffs, type = "l")
abline(v = ombc_lcwm_mlr_p1$outlier_num)
plot(
x = noisy_mlr_p1$covariates[, 1],
y = noisy_mlr_p1$responses,
pch = 1 + noisy_mlr_p1$labels,
col = 1 + ombc_lcwm_mlr_p1$outlier_bool
)
par(mfrow = c(1, 1))
ombc_lcwm_mlr_p1$outlier_num == ombc_mlr_p1$outlier_num
sum(ombc_lcwm_mlr_p1$distrib_diffs != ombc_mlr_p1$distrib_diffs)
sum(ombc_lcwm_mlr_p1$outlier_rank != ombc_mlr_p1$outlier_rank)
min(ombc_lcwm_mlr_p1$distrib_diffs - ombc_mlr_p1$distrib_diffs)
n_vec <- c(2000, 1000, 1000)
mu_list <- list(c(-1, 0), c(+1, -1), c(+1, +1))
sigma_list <- list(
diag(c(0.2, 4 * 0.2)),
diag(c(0.2, 0.2)),
diag(c(0.2, 0.2))
)
noisy_gmm_p2g3 <- simulate_noisy_gmm(
n_vec, mu_list, sigma_list,
outlier_num = 40, seed = 123, crit_val = 0.9999,
unif_range_multiplier = 1.5
)
ombc_gmm_p2g3 <- ombc_gmm(noisy_gmm_p2g3[, 1:2], comp_num = 3, max_out = 80)
par(mfrow = c(1, 2))
plot(0:80, ombc_gmm_p2g3$distrib_diffs, type = "l")
abline(v = ombc_gmm_p2g3$outlier_num)
plot(noisy_gmm_p2g3[, 1:2], col = ombc_gmm_p2g3$gmm_labels,
pch = 1 + noisy_gmm_p2g3[, 3])
par(mfrow = c(1, 1))
head(noisy_gmm_p2g3)
ombc_gmm_lcwm_p2g3 <- ombc_lcwm(
x = noisy_gmm_p2g3[, -3],
comp_num = 3,
max_out = 80,
mnames = "VVV",
outlier_type = "x_only"
)
